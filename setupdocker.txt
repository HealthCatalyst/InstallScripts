#!/bin/sh
set -e
#
# This script is meant for quick & easy install via:
#   'curl -sSL https://healthcatalyst.github.io/InstallScripts/setupdocker.txt | sh'
# or:
#   'wget -qO- https://healthcatalyst.github.io/InstallScripts/setupdocker.txt | sh'
#
#

sudo systemctl enable docker.service

sudo systemctl enable docker

sudo systemctl start docker

docker run --rm hello-world

echo "docker is setup now"

# echo "setting up a cleanup job"
# echo "0 2 * * * /bin/sh backup.sh" | sudo tee -a /etc/cron.d/docker_cleanup


doSetupSwarm=""

read -e -p "Do you wish to setup docker swarm cluster now?" yn < /dev/tty
case $yn in
    [Yy]* ) doSetupSwarm="yes"; break;;
    [Nn]* ) break;;
    * ) echo "Please answer yes or no.";;
esac

if [[ ! -z "$doSetupSwarm" ]]; then
    curl -sSL https://healthcatalyst.github.io/InstallScripts/docker/joinswarm.txt | sh
fi
