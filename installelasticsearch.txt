#!/bin/sh
set -e
#
# This script is meant for quick & easy install via:
#   'curl -sSL https://imranq2.github.io/InstallScripts/installelasticsearch.txt | sh -s <nodename> <ip1> <ip2> <ip3>'
#   'curl -sSL https://imranq2.github.io/InstallScripts/installelasticsearch.txt | sh -s master 10.0.0.4 10.0.0.5 10.0.0.6'
# or:
#   'wget -qO- https://imranq2.github.io/InstallScripts/installelasticsearch.txt | sh -s <nodename> <ip1> <ip2> <ip3>'
#
#

echo "Starting setup..."

# echo "param 1: [" $1 "]"

# no spaces allowed in variable set commands
MyNodeName="$1"
ip1="$2"
ip2="$3"
ip3="$4"


echo "node name: [$MyNodeName]" 
echo "ip1: $ip1"
echo "ip2: $ip2"
echo "ip3: $ip3"

echo "Creating update script"

echo "#!/bin/sh" > /opt/updateelasticsearch
echo "docker stop dockerelasticsearch" >> /opt/updateelasticsearch
echo "docker rm dockerelasticsearch" >> /opt/updateelasticsearch
echo "docker rmi imranq2/dockerelasticsearch" >> /opt/updateelasticsearch
echo "docker pull imranq2/dockerelasticsearch" >> /opt/updateelasticsearch